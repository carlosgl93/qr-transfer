import{b as x,k as L,i as q,l as O,E as U,j as i,o as Q,n as Z,q as F,a0 as b,$,H as S,I as M,J}from"./deepmerge-CTR-2iFl.js";import{e as K,u as _,a as X,L as Y,B as E,S as C,T as m}from"./App-Cl4K1hj7.js";import{C as ee,a as te,b as ne,c as re,d as G,q as se,g as ie,e as oe,f as ae}from"./firebase-Cjtt-dVy.js";import{u as ce}from"./useAuth-D9SyyZ3A.js";import{P as le}from"./ProtectedRoute-DnmPADbU.js";import{A as ue}from"./Alert-CWRSxdOE.js";import"./index-K4Q6e0cW.js";const A=x.createContext();function de(e){return L("MuiGrid",e)}const pe=[0,1,2,3,4,5,6,7,8,9,10],fe=["column-reverse","column","row-reverse","row"],he=["nowrap","wrap-reverse","wrap"],g=["auto",!0,1,2,3,4,5,6,7,8,9,10,11,12],v=q("MuiGrid",["root","container","item","zeroMinWidth",...pe.map(e=>`spacing-xs-${e}`),...fe.map(e=>`direction-xs-${e}`),...he.map(e=>`wrap-xs-${e}`),...g.map(e=>`grid-xs-${e}`),...g.map(e=>`grid-sm-${e}`),...g.map(e=>`grid-md-${e}`),...g.map(e=>`grid-lg-${e}`),...g.map(e=>`grid-xl-${e}`)]);function me({theme:e,ownerState:t}){let s;return e.breakpoints.keys.reduce((r,n)=>{let o={};if(t[n]&&(s=t[n]),!s)return r;if(s===!0)o={flexBasis:0,flexGrow:1,maxWidth:"100%"};else if(s==="auto")o={flexBasis:"auto",flexGrow:0,flexShrink:0,maxWidth:"none",width:"auto"};else{const l=b({values:t.columns,breakpoints:e.breakpoints.values}),u=typeof l=="object"?l[n]:l;if(u==null)return r;const a=`${Math.round(s/u*1e8)/1e6}%`;let c={};if(t.container&&t.item&&t.columnSpacing!==0){const d=e.spacing(t.columnSpacing);if(d!=="0px"){const p=`calc(${a} + ${d})`;c={flexBasis:p,maxWidth:p}}}o={flexBasis:a,flexGrow:0,maxWidth:a,...c}}return e.breakpoints.values[n]===0?Object.assign(r,o):r[e.breakpoints.up(n)]=o,r},{})}function xe({theme:e,ownerState:t}){const s=b({values:t.direction,breakpoints:e.breakpoints.values});return $({theme:e},s,r=>{const n={flexDirection:r};return r.startsWith("column")&&(n[`& > .${v.item}`]={maxWidth:"none"}),n})}function D({breakpoints:e,values:t}){let s="";Object.keys(t).forEach(n=>{s===""&&t[n]!==0&&(s=n)});const r=Object.keys(e).sort((n,o)=>e[n]-e[o]);return r.slice(0,r.indexOf(s))}function ge({theme:e,ownerState:t}){const{container:s,rowSpacing:r}=t;let n={};if(s&&r!==0){const o=b({values:r,breakpoints:e.breakpoints.values});let l;typeof o=="object"&&(l=D({breakpoints:e.breakpoints.values,values:o})),n=$({theme:e},o,(u,a)=>{const c=e.spacing(u);return c!=="0px"?{marginTop:`calc(-1 * ${c})`,[`& > .${v.item}`]:{paddingTop:c}}:l!=null&&l.includes(a)?{}:{marginTop:0,[`& > .${v.item}`]:{paddingTop:0}}})}return n}function ve({theme:e,ownerState:t}){const{container:s,columnSpacing:r}=t;let n={};if(s&&r!==0){const o=b({values:r,breakpoints:e.breakpoints.values});let l;typeof o=="object"&&(l=D({breakpoints:e.breakpoints.values,values:o})),n=$({theme:e},o,(u,a)=>{const c=e.spacing(u);if(c!=="0px"){const d=`calc(-1 * ${c})`;return{width:`calc(100% + ${c})`,marginLeft:d,[`& > .${v.item}`]:{paddingLeft:c}}}return l!=null&&l.includes(a)?{}:{width:"100%",marginLeft:0,[`& > .${v.item}`]:{paddingLeft:0}}})}return n}function je(e,t,s={}){if(!e||e<=0)return[];if(typeof e=="string"&&!Number.isNaN(Number(e))||typeof e=="number")return[s[`spacing-xs-${String(e)}`]];const r=[];return t.forEach(n=>{const o=e[n];Number(o)>0&&r.push(s[`spacing-${n}-${String(o)}`])}),r}const be=Q("div",{name:"MuiGrid",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:s}=e,{container:r,direction:n,item:o,spacing:l,wrap:u,zeroMinWidth:a,breakpoints:c}=s;let d=[];r&&(d=je(l,c,t));const p=[];return c.forEach(f=>{const h=s[f];h&&p.push(t[`grid-${f}-${String(h)}`])}),[t.root,r&&t.container,o&&t.item,a&&t.zeroMinWidth,...d,n!=="row"&&t[`direction-xs-${String(n)}`],u!=="wrap"&&t[`wrap-xs-${String(u)}`],...p]}})(({ownerState:e})=>({boxSizing:"border-box",...e.container&&{display:"flex",flexWrap:"wrap",width:"100%"},...e.item&&{margin:0},...e.zeroMinWidth&&{minWidth:0},...e.wrap!=="wrap"&&{flexWrap:e.wrap}}),xe,ge,ve,me);function ye(e,t){if(!e||e<=0)return[];if(typeof e=="string"&&!Number.isNaN(Number(e))||typeof e=="number")return[`spacing-xs-${String(e)}`];const s=[];return t.forEach(r=>{const n=e[r];if(Number(n)>0){const o=`spacing-${r}-${String(n)}`;s.push(o)}}),s}const we=e=>{const{classes:t,container:s,direction:r,item:n,spacing:o,wrap:l,zeroMinWidth:u,breakpoints:a}=e;let c=[];s&&(c=ye(o,a));const d=[];a.forEach(f=>{const h=e[f];h&&d.push(`grid-${f}-${String(h)}`)});const p={root:["root",s&&"container",n&&"item",u&&"zeroMinWidth",...c,r!=="row"&&`direction-xs-${String(r)}`,l!=="wrap"&&`wrap-xs-${String(l)}`,...d]};return F(p,de,t)},B=x.forwardRef(function(t,s){const r=O({props:t,name:"MuiGrid"}),{breakpoints:n}=U(),o=K(r),{className:l,columns:u,columnSpacing:a,component:c="div",container:d=!1,direction:p="row",item:f=!1,rowSpacing:h,spacing:y=0,wrap:I="wrap",zeroMinWidth:R=!1,...w}=o,V=h||y,P=a||y,H=x.useContext(A),z=d?u||12:H,k={},N={...w};n.keys.forEach(j=>{w[j]!=null&&(k[j]=w[j],delete N[j])});const W={...o,columns:z,container:d,direction:p,item:f,rowSpacing:V,columnSpacing:P,wrap:I,zeroMinWidth:R,spacing:y,...k,breakpoints:n.keys},T=we(W);return i.jsx(A.Provider,{value:z,children:i.jsx(be,{ownerState:W,className:Z(T.root,l),as:c,ref:s,...N})})}),Ce=S(i.jsx("path",{d:"M19 13h-6v6h-2v-6H5v-2h6V5h2v6h6z"}),"Add"),$e=S(i.jsx("path",{d:"M3 11h8V3H3zm2-6h4v4H5zM3 21h8v-8H3zm2-6h4v4H5zm8-12v8h8V3zm6 6h-4V5h4zm0 10h2v2h-2zm-6-6h2v2h-2zm2 2h2v2h-2zm-2 2h2v2h-2zm2 2h2v2h-2zm2-2h2v2h-2zm0-4h2v2h-2zm2 2h2v2h-2z"}),"QrCode"),Se=S(i.jsx("path",{d:"M6 19c0 1.1.9 2 2 2h8c1.1 0 2-.9 2-2V7H6zM19 4h-3.5l-1-1h-5l-1 1H5v2h14z"}),"Delete");function ze(){const{user:e}=ce(),t=_(),s=X(),[r,n]=x.useState([]),[o,l]=x.useState(!0);x.useEffect(()=>{if(!e)return;(async()=>{try{const c=re(G,"users",e.uid,"bankAccounts"),d=se(c),p=await ie(d),f=[];p.forEach(h=>{f.push({id:h.id,...h.data()})}),n(f)}catch(c){console.error("Error fetching accounts:",c),s.show("Error al cargar las cuentas",{severity:"error"})}finally{l(!1)}})()},[e,s]);const u=async a=>{if(!(!e||!a)&&window.confirm("¿Estás seguro de eliminar esta cuenta?"))try{await oe(ae(G,"users",e.uid,"bankAccounts",a)),n(r.filter(c=>c.id!==a)),s.show("Cuenta eliminada",{severity:"success",autoHideDuration:3e3})}catch(c){console.error("Error deleting account:",c),s.show("Error al eliminar la cuenta",{severity:"error"})}};return o?i.jsx(Y,{}):i.jsxs(ee,{maxWidth:"lg",children:[i.jsx("meta",{name:"title",content:"Mis Cuentas Bancarias"}),i.jsxs(E,{sx:{mt:4,mb:4},children:[i.jsxs(C,{direction:"row",justifyContent:"space-between",alignItems:"center",sx:{mb:3},children:[i.jsx(m,{variant:"h4",component:"h1",children:"Mis Cuentas Bancarias"}),i.jsx(M,{variant:"contained",startIcon:i.jsx(Ce,{}),onClick:()=>t("/add-account"),children:"Agregar Cuenta"})]}),r.length===0?i.jsx(ue,{severity:"info",children:'No tienes cuentas bancarias registradas. Haz clic en "Agregar Cuenta" para comenzar.'}):i.jsx(B,{container:!0,spacing:3,children:r.map(a=>i.jsx(B,{item:!0,xs:12,md:6,children:i.jsx(te,{children:i.jsx(ne,{children:i.jsxs(C,{spacing:2,children:[i.jsxs(C,{direction:"row",justifyContent:"space-between",alignItems:"flex-start",children:[i.jsx(m,{variant:"h6",component:"h2",children:a.fullName}),i.jsx(J,{size:"small",color:"error",onClick:()=>u(a.id),children:i.jsx(Se,{})})]}),i.jsxs(E,{children:[i.jsxs(m,{variant:"body2",color:"text.secondary",children:["RUT: ",a.rut]}),i.jsx(m,{variant:"body2",color:"text.secondary",children:a.bankOrPlatform}),i.jsx(m,{variant:"body2",color:"text.secondary",children:a.accountType}),i.jsxs(m,{variant:"body2",color:"text.secondary",children:["Cuenta: ",a.accountNumber]}),i.jsx(m,{variant:"body2",color:"text.secondary",children:a.email})]}),i.jsx(M,{variant:"outlined",startIcon:i.jsx($e,{}),onClick:()=>t(`/qr/${a.id}`),fullWidth:!0,children:"Ver Código QR"})]})})})},a.id))})]})]})}function Be(){return i.jsx(le,{children:i.jsx(ze,{})})}export{Be as default};
