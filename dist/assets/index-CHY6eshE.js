import{H as h,j as e,b as i,I as x,J as C}from"./hooks-BWlgxfag.js";import{a as A,u as w,L as H,B as f,S as c,T as s,c as E,d as j,q as D,g as I,b as k,e as M}from"./App-BXi3ZNGz.js";import{P as B}from"./ProtectedRoute-BDlj4639.js";import{C as S,a as V,b as q}from"./Container-DAXyd3cS.js";import{A as N}from"./Alert-C_YSVmH4.js";import{G as v}from"./Grid-DoNr8ZW3.js";import{u as R}from"./useNotifications-BpYlB5BH.js";import"./index-Crojux0P.js";import"./NotificationsContext-BH5vbCom.js";const T=h(e.jsx("path",{d:"M19 13h-6v6h-2v-6H5v-2h6V5h2v6h6z"}),"Add"),L=h(e.jsx("path",{d:"M3 11h8V3H3zm2-6h4v4H5zM3 21h8v-8H3zm2-6h4v4H5zm8-12v8h8V3zm6 6h-4V5h4zm0 10h2v2h-2zm-6-6h2v2h-2zm2 2h2v2h-2zm-2 2h2v2h-2zm2 2h2v2h-2zm2-2h2v2h-2zm0-4h2v2h-2zm2 2h2v2h-2z"}),"QrCode"),P=h(e.jsx("path",{d:"M6 19c0 1.1.9 2 2 2h8c1.1 0 2-.9 2-2V7H6zM19 4h-3.5l-1-1h-5l-1 1H5v2h14z"}),"Delete");function Q(){const{user:a}=A(),d=w(),n=R(),[o,l]=i.useState([]),[p,y]=i.useState(!0);i.useEffect(()=>{if(!a)return;(async()=>{try{const r=E(j,"users",a.uid,"bankAccounts"),b=D(r),z=await I(b),u=[];z.forEach(m=>{u.push({id:m.id,...m.data()})}),l(u)}catch(r){console.error("Error fetching accounts:",r),n.show("Error al cargar las cuentas",{severity:"error"})}finally{y(!1)}})()},[a,n]);const g=async t=>{if(!(!a||!t)&&window.confirm("¿Estás seguro de eliminar esta cuenta?"))try{await k(M(j,"users",a.uid,"bankAccounts",t)),l(o.filter(r=>r.id!==t)),n.show("Cuenta eliminada",{severity:"success",autoHideDuration:3e3})}catch(r){console.error("Error deleting account:",r),n.show("Error al eliminar la cuenta",{severity:"error"})}};return p?e.jsx(H,{}):e.jsxs(S,{maxWidth:"lg",children:[e.jsx("meta",{name:"title",content:"Mis Cuentas Bancarias"}),e.jsxs(f,{sx:{mt:4,mb:4},children:[e.jsxs(c,{direction:"row",justifyContent:"space-between",alignItems:"center",sx:{mb:3},children:[e.jsx(s,{variant:"h4",component:"h1",children:"Mis Cuentas Bancarias"}),e.jsx(x,{variant:"contained",startIcon:e.jsx(T,{}),onClick:()=>d("/add-account"),children:"Agregar Cuenta"})]}),o.length===0?e.jsx(N,{severity:"info",children:'No tienes cuentas bancarias registradas. Haz clic en "Agregar Cuenta" para comenzar.'}):e.jsx(v,{container:!0,spacing:3,children:o.map(t=>e.jsx(v,{item:!0,xs:12,md:6,children:e.jsx(V,{children:e.jsx(q,{children:e.jsxs(c,{spacing:2,children:[e.jsxs(c,{direction:"row",justifyContent:"space-between",alignItems:"flex-start",children:[e.jsx(s,{variant:"h6",component:"h2",children:t.fullName}),e.jsx(C,{size:"small",color:"error",onClick:()=>g(t.id),children:e.jsx(P,{})})]}),e.jsxs(f,{children:[e.jsxs(s,{variant:"body2",color:"text.secondary",children:["RUT: ",t.rut]}),e.jsx(s,{variant:"body2",color:"text.secondary",children:t.bankOrPlatform}),e.jsx(s,{variant:"body2",color:"text.secondary",children:t.accountType}),e.jsxs(s,{variant:"body2",color:"text.secondary",children:["Cuenta: ",t.accountNumber]}),e.jsx(s,{variant:"body2",color:"text.secondary",children:t.email})]}),e.jsx(x,{variant:"outlined",startIcon:e.jsx(L,{}),onClick:()=>d(`/qr/${t.id}`),fullWidth:!0,children:"Ver Código QR"})]})})})},t.id))})]})]})}function Y(){return e.jsx(B,{children:e.jsx(Q,{})})}export{Y as default};
